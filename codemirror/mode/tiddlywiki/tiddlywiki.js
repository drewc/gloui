(function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)})((function(e){"use strict";e.defineMode("tiddlywiki",(function(){var e={},t={allTags:!0,closeAll:!0,list:!0,newJournal:!0,newTiddler:!0,permaview:!0,saveChanges:!0,search:!0,slider:!0,tabs:!0,tag:!0,tagging:!0,tags:!0,tiddler:!0,timeline:!0,today:!0,version:!0,option:!0,with:!0,filter:!0},r=/[\w_\-]/i,n=/^\-\-\-\-+$/,i=/^\/\*\*\*$/,o=/^\*\*\*\/$/,u=/^<<<$/,a=/^\/\/\{\{\{$/,f=/^\/\/\}\}\}$/,c=/^<!--\{\{\{-->$/,l=/^<!--\}\}\}-->$/,m=/^\{\{\{$/,h=/^\}\}\}$/,k=/.*?\}\}\}/;function d(e,t,r){return t.tokenize=r,r(e,t)}function s(t,h){var k=t.sol(),s=t.peek();if(h.block=!1,k&&/[<\/\*{}\-]/.test(s)){if(t.match(m))return h.block=!0,d(t,h,w);if(t.match(u))return"quote";if(t.match(i)||t.match(o))return"comment";if(t.match(a)||t.match(f)||t.match(c)||t.match(l))return"comment";if(t.match(n))return"hr"}if(t.next(),k&&/[\/\*!#;:>|]/.test(s)){if("!"==s)return t.skipToEnd(),"header";if("*"==s)return t.eatWhile("*"),"comment";if("#"==s)return t.eatWhile("#"),"comment";if(";"==s)return t.eatWhile(";"),"comment";if(":"==s)return t.eatWhile(":"),"comment";if(">"==s)return t.eatWhile(">"),"quote";if("|"==s)return"header"}if("{"==s&&t.match(/\{\{/))return d(t,h,w);if(/[hf]/i.test(s)&&/[ti]/i.test(t.peek())&&t.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i))return"link";if('"'==s)return"string";if("~"==s)return"brace";if(/[\[\]]/.test(s)&&t.match(s))return"brace";if("@"==s)return t.eatWhile(r),"link";if(/\d/.test(s))return t.eatWhile(/\d/),"number";if("/"==s){if(t.eat("%"))return d(t,h,b);if(t.eat("/"))return d(t,h,$)}if("_"==s&&t.eat("_"))return d(t,h,v);if("-"==s&&t.eat("-")){if(" "!=t.peek())return d(t,h,x);if(" "==t.peek())return"brace"}return"'"==s&&t.eat("'")?d(t,h,p):"<"==s&&t.eat("<")?d(t,h,y):(t.eatWhile(/[\w\$_]/),e.propertyIsEnumerable(t.current())?"keyword":null)}function b(e,t){var r,n=!1;while(r=e.next()){if("/"==r&&n){t.tokenize=s;break}n="%"==r}return"comment"}function p(e,t){var r,n=!1;while(r=e.next()){if("'"==r&&n){t.tokenize=s;break}n="'"==r}return"strong"}function w(e,t){var r=t.block;return r&&e.current()?"comment":!r&&e.match(k)||r&&e.sol()&&e.match(h)?(t.tokenize=s,"comment"):(e.next(),"comment")}function $(e,t){var r,n=!1;while(r=e.next()){if("/"==r&&n){t.tokenize=s;break}n="/"==r}return"em"}function v(e,t){var r,n=!1;while(r=e.next()){if("_"==r&&n){t.tokenize=s;break}n="_"==r}return"underlined"}function x(e,t){var r,n=!1;while(r=e.next()){if("-"==r&&n){t.tokenize=s;break}n="-"==r}return"strikethrough"}function y(e,r){if("<<"==e.current())return"macro";var n=e.next();return n?">"==n&&">"==e.peek()?(e.next(),r.tokenize=s,"macro"):(e.eatWhile(/[\w\$_]/),t.propertyIsEnumerable(e.current())?"keyword":null):(r.tokenize=s,null)}return{startState:function(){return{tokenize:s}},token:function(e,t){if(e.eatSpace())return null;var r=t.tokenize(e,t);return r}}})),e.defineMIME("text/x-tiddlywiki","tiddlywiki")}));