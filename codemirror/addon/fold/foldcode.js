(function(n){"object"==typeof exports&&"object"==typeof module?n(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)})((function(n){"use strict";function o(o,r,t,l){if(t&&t.call){var f=t;t=null}else f=i(o,t,"rangeFinder");"number"==typeof r&&(r=n.Pos(r,0));var d=i(o,t,"minFoldSize");function u(n){var e=f(o,r);if(!e||e.to.line-e.from.line<d)return null;for(var i=o.findMarksAt(e.from),t=0;t<i.length;++t)if(i[t].__isFold&&"fold"!==l){if(!n)return null;e.cleared=!0,i[t].clear()}return e}var a=u(!0);if(i(o,t,"scanUp"))while(!a&&r.line>o.firstLine())r=n.Pos(r.line-1,0),a=u(!1);if(a&&!a.cleared&&"unfold"!==l){var c=e(o,t,a);n.on(c,"mousedown",(function(o){s.clear(),n.e_preventDefault(o)}));var s=o.markText(a.from,a.to,{replacedWith:c,clearOnEnter:i(o,t,"clearOnEnter"),__isFold:!0});s.on("clear",(function(e,r){n.signal(o,"unfold",o,e,r)})),n.signal(o,"fold",o,a.from,a.to)}}function e(n,o,e){var r=i(n,o,"widget");if("function"==typeof r&&(r=r(e.from,e.to)),"string"==typeof r){var t=document.createTextNode(r);r=document.createElement("span"),r.appendChild(t),r.className="CodeMirror-foldmarker"}else r&&(r=r.cloneNode(!0));return r}n.newFoldFunction=function(n,e){return function(r,i){o(r,i,{rangeFinder:n,widget:e})}},n.defineExtension("foldCode",(function(n,e,r){o(this,n,e,r)})),n.defineExtension("isFolded",(function(n){for(var o=this.findMarksAt(n),e=0;e<o.length;++e)if(o[e].__isFold)return!0})),n.commands.toggleFold=function(n){n.foldCode(n.getCursor())},n.commands.fold=function(n){n.foldCode(n.getCursor(),null,"fold")},n.commands.unfold=function(n){n.foldCode(n.getCursor(),null,"unfold")},n.commands.foldAll=function(o){o.operation((function(){for(var e=o.firstLine(),r=o.lastLine();e<=r;e++)o.foldCode(n.Pos(e,0),null,"fold")}))},n.commands.unfoldAll=function(o){o.operation((function(){for(var e=o.firstLine(),r=o.lastLine();e<=r;e++)o.foldCode(n.Pos(e,0),null,"unfold")}))},n.registerHelper("fold","combine",(function(){var n=Array.prototype.slice.call(arguments,0);return function(o,e){for(var r=0;r<n.length;++r){var i=n[r](o,e);if(i)return i}}})),n.registerHelper("fold","auto",(function(n,o){for(var e=n.getHelpers(o,"fold"),r=0;r<e.length;r++){var i=e[r](n,o);if(i)return i}}));var r={rangeFinder:n.fold.auto,widget:"â†”",minFoldSize:0,scanUp:!1,clearOnEnter:!0};function i(n,o,e){if(o&&void 0!==o[e])return o[e];var i=n.options.foldOptions;return i&&void 0!==i[e]?i[e]:r[e]}n.defineOption("foldOptions",null),n.defineExtension("foldOption",(function(n,o){return i(this,n,o)}))}));